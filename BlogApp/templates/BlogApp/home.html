{% extends "BlogApp/base.html" %}
{% load crispy_forms_tags %}
{% block content %}



	{% for post in posts reversed %}
	<article class="media content-section">
		<div class="d-flex"> 
			<img class= "rounded-circle article-img" src="{{post.autor.profile.image.url}}" alt="">
			<div class="media-body flex-grow-1"> 
				<div class="article-metadata">
					<a class="mr-2" href="#">{{ post.autor }}</a>
					<small class="text-muted">{{ post.data|date:"d M Y H:i" }}</small>
				</div>
				<h2><a class="article-title" href="{% url "post-detail" post.id %}">{{ post.titulo }}</a></h2>
				<p class="article-content">{{ post.conteudo }}</p>
			</div>
		</div>
	</article>
	{% endfor %}
{% endblock content %}

{% block content_2 %}
	{% if user.is_authenticated %}
		<div class="d-flex justify-content-center"  >
			<button class="btn btn-outline-info mt-4 mb-4" id="fazer-post-btn">Fazer um post</button>
		</div>

		<script>
			document.getElementById("fazer-post-btn").addEventListener("click", function() {
				var form = document.getElementById("post-form");
				var botao = document.getElementById("fazer-post-btn");

				if (form.style.display === "none"){
					form.style.display = "block";
					botao.innerText = "Voltar";
				} else {
					form.style.display = "none";
					botao.innerText = "Fazer um Post";
				}
			});
		</script>

		<div class="content-section" id="post-form" style="display: none; position: sticky;">
			<form method="POST">
				{% csrf_token %}
				<fieldset class="form-group">
					<legend class="border-bottom mb-4">Fazer uma Postagem</legend>
					{{form|crispy}}
				</fieldset>
				<div class="form-group mt-4 mb-2">
					<button class="btn btn-outline-info" type="submit">Postar</button>
				</div>
			</form>
		</div>
	

	{% endif %}
{% endblock content_2 %}
